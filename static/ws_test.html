<!--
Developer-only WebSocket test client.
Used during Phase 2 & 3 to validate connection lifecycle and room TTL.
Not part of production UI.
-->
<!DOCTYPE html>
<html>
<head>
  <title>Sub Rosa – Phase 4</title>
  <style>
    body { font-family: monospace; background: #111; color: #eee; }
    .msg { margin: 6px 0; }
  </style>
</head>
<body>

<h3>Sub Rosa – Ephemeral Chat</h3>
<div id="chat"></div>

<input id="input" placeholder="message..." />
<button onclick="send()">Send</button>

<script>
  const chat = document.getElementById("chat");
  const ws = new WebSocket("ws://localhost:8000/ws?room_id=bFnA6t");

  ws.onmessage = (e) => {
    const msg = JSON.parse(e.data);

    if (msg.type === "MESSAGE") {
      const el = document.createElement("div");
      el.className = "msg";
      el.textContent = `[${msg.sender}] ${msg.content}`;
      chat.appendChild(el);

      setTimeout(() => {
        el.remove();
      }, msg.expires_in * 1000);
    }
  };

  function send() {
    const input = document.getElementById("input");
    ws.send(JSON.stringify({
      type: "MESSAGE",
      sender: "anonymous",
      content: input.value,
      expires_in: 5
    }));
    input.value = "";
  }
</script>

</body>
</html>

